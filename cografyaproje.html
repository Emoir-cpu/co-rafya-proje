<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Umut Vadisi'nin Kaderi - CoÄŸrafya Oyunu</title>
    <!-- Google Font Import -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* --- Renk Paleti ve Temel Ayarlar --- */
        :root {
            --primary-color: #0077b6; /* Daha canlÄ± bir mavi */
            --secondary-color: #00b4d8; /* AÃ§Ä±k mavi tonu */
            --accent-color: #fb8500;  /* Vurgu iÃ§in turuncu */
            --success-color: #2a9d8f; /* BaÅŸarÄ± yeÅŸili */
            --error-color: #e63946;   /* Hata kÄ±rmÄ±zÄ±sÄ± */
            --light-bg: #f8f9fa;     /* AÃ§Ä±k arka plan */
            --dark-text: #343a40;    /* Koyu metin */
            --medium-text: #6c757d;  /* Orta ton metin */
            --border-color: #dee2e6; /* KenarlÄ±k rengi */
            --white: #ffffff;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Nunito', sans-serif; /* Modern font */
            line-height: 1.7; /* Daha rahat okunabilirlik */
            margin: 0;
            padding: 20px; /* Kenarlardan boÅŸluk */
            background-color: var(--light-bg);
            color: var(--dark-text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        #game-container {
            background-color: var(--white);
            border-radius: 12px; /* Daha yuvarlak kÃ¶ÅŸeler */
            box-shadow: 0 6px 20px var(--shadow-color); /* Daha belirgin gÃ¶lge */
            padding: 35px 40px; /* Ä°Ã§ boÅŸluklar */
            width: 90%;
            max-width: 750px; /* Biraz daha geniÅŸ */
            position: relative;
            overflow: hidden;
            box-sizing: border-box;
            border: 1px solid var(--border-color); /* Hafif kenarlÄ±k */
        }

        /* --- Ã–ÄŸrenci Bilgisi --- */
        #student-info {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 0.85em; /* Biraz daha bÃ¼yÃ¼k */
            font-weight: 500; /* Biraz daha kalÄ±n */
            color: var(--medium-text); /* Orta ton gri */
            background-color: rgba(233, 236, 239, 0.7); /* Hafif arka plan */
            padding: 3px 8px;
            border-radius: 4px;
        }

        /* --- Ekran YÃ¶netimi --- */
        .screen { display: none; width: 100%; }
        .screen.active { display: block; animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Genel BaÅŸlÄ±k Stilleri --- */
        h1, h2 { color: var(--primary-color); text-align: center; margin-bottom: 25px; }
        h1 { font-size: 2em; color: var(--dark-text); }
        h2 { font-size: 1.6em; margin-bottom: 20px; }

        /* --- Ana MenÃ¼ --- */
        #main-menu .menu-buttons { display: flex; flex-direction: column; align-items: center; gap: 18px; margin-top: 30px; }
        .menu-buttons button {
            padding: 14px 30px;
            font-size: 1.15em;
            font-weight: 700; /* Daha kalÄ±n yazÄ± */
            cursor: pointer;
            border: none;
            border-radius: 8px;
            background: linear-gradient(145deg, var(--primary-color), var(--secondary-color)); /* Gradient arka plan */
            color: var(--white);
            transition: all 0.3s ease;
            width: 250px;
            position: relative;
            box-shadow: 0 4px 8px var(--shadow-color);
            text-align: center; /* Metni ortala */
        }
        .menu-buttons button:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.02); /* Hafif kalkma ve bÃ¼yÃ¼me */
            box-shadow: 0 6px 12px rgba(0, 119, 182, 0.3); /* Mavi tonlu gÃ¶lge */
        }
        .menu-buttons button:disabled {
            background: var(--border-color);
            color: var(--medium-text);
            cursor: not-allowed;
            box-shadow: none;
        }

        /* --- Kilit Ä°konu YÃ¶netimi (DÃœZELTÄ°LDÄ°) --- */
        .menu-buttons button .lock-icon {
            display: none; /* VarsayÄ±lan olarak gizli */
            font-size: 1em;
            margin-left: 10px;
            color: var(--medium-text); /* Kilitli buton ikonu rengi */
        }
        /* Sadece .locked sÄ±nÄ±fÄ±na sahip (ve disabled olan) butonlarda ikonu gÃ¶ster */
        .menu-buttons button.locked .lock-icon {
            display: inline;
        }
        /* AÃ§Ä±k (unlocked) butonlarda ikonu kesin gizle */
         .menu-buttons button:not(.locked) .lock-icon {
            display: none;
         }


        /* --- NasÄ±l OynanÄ±r EkranÄ± --- */
        #how-to-play h2 { color: var(--accent-color); }
        #how-to-play p {
            margin-bottom: 15px;
            background-color: var(--light-bg);
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid var(--accent-color);
        }
        #how-to-play button {
            display: block; margin: 30px auto 0 auto; padding: 12px 28px;
            background-color: var(--error-color); color: var(--white); font-weight: 700;
            border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.3s ease; font-size: 1em;
        }
        #how-to-play button:hover { background-color: #c91828; }

        /* --- Oyun EkranÄ± --- */
        #game-screen h2 { color: var(--success-color); font-size: 1.7em; }
        #story-text {
            min-height: 140px; margin-bottom: 30px;
            background-color: #e9ecef; /* Hafif gri arka plan */
            border-left: 6px solid var(--secondary-color);
            padding: 20px; border-radius: 8px;
            font-size: 1.1em; color: var(--dark-text);
            overflow-wrap: break-word;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        #choices { display: flex; flex-direction: column; gap: 15px; }
        #choices button {
            padding: 15px 20px; font-size: 1.05em; font-weight: 500;
            cursor: pointer; border: 2px solid var(--border-color);
            border-radius: 8px; background-color: var(--white); color: var(--dark-text);
            transition: all 0.3s ease; text-align: left; line-height: 1.5;
        }
        #choices button:hover:not(:disabled) {
            background-color: #e0f7fa; /* AÃ§Ä±k mavi hover */
            border-color: var(--secondary-color);
            transform: translateX(5px);
            box-shadow: 0 2px 4px var(--shadow-color);
        }
        #choices button:disabled {
            opacity: 0.7; cursor: default; background-color: var(--light-bg);
            transform: none; box-shadow: none;
        }
        #feedback {
            margin-top: 25px; font-weight: 700; text-align: center;
            padding: 15px; border-radius: 8px; min-height: 25px;
            transition: all 0.4s ease; font-size: 1.05em;
        }
        #feedback.correct { background-color: #d1fae5; color: #047857; border: 1px solid #6ee7b7; }
        #feedback.incorrect { background-color: #fee2e2; color: #b91c1c; border: 1px solid #fca5a5; }

        /* --- BitiÅŸ EkranlarÄ± --- */
        .end-screen h2 { font-size: 1.8em; margin-bottom: 15px; }
        .end-screen p { text-align: center; margin-bottom: 30px; font-size: 1.2em; padding: 0 20px; color: var(--medium-text); }
        .end-screen button {
             display: inline-block; /* Yan yana durabilmeleri iÃ§in */
             margin: 10px; /* Butonlar arasÄ± boÅŸluk */
             padding: 12px 25px; background-color: var(--primary-color);
             color: var(--white); font-weight: 700; border: none; border-radius: 8px;
             cursor: pointer; transition: all 0.3s ease; font-size: 1em;
        }
        .end-screen button:hover { background-color: #005f8d; transform: translateY(-2px); }
        #level-complete h2 { color: var(--success-color); }
        #game-over h2 { color: var(--error-color); }
         /* Ã–zel Buton Renkleri */
        #next-level-btn { background-color: var(--success-color); }
        #next-level-btn:hover { background-color: #218a7e; }
        #restart-level-btn { background-color: var(--accent-color); }
        #restart-level-btn:hover { background-color: #d97000; }
         .end-screen .button-container { /* ButonlarÄ± ortalamak iÃ§in */
             text-align: center;
             margin-top: 20px;
         }


        /* --- YazÄ± Efekti Ä°mleci --- */
        .typewriter-cursor::after {
            content: '|';
            animation: blink 0.7s step-end infinite;
            margin-left: 4px; font-weight: bold; color: var(--medium-text);
            position: relative; top: -1px; font-size: 1.1em;
        }
        @keyframes blink { 50% { opacity: 0; } }

        /* --- Ana MenÃ¼ye DÃ¶n Butonu (Oyun Ä°Ã§i) --- */
        button#back-to-menu-from-game {
             margin: 25px auto 0 auto; background-color: var(--medium-text);
             color: var(--white); border: none; padding: 8px 18px;
             border-radius: 6px; cursor: pointer; display: block;
             font-size: 0.9em; transition: background-color 0.3s ease;
             font-weight: 700;
        }
        button#back-to-menu-from-game:hover{ background-color: #5a6268; }

    </style>
</head>
<body>

    <div id="game-container">
        <div id="student-info">Emir Pamukcu 607 9/B</div>

        <!-- 1. Ana MenÃ¼ EkranÄ± -->
        <div id="main-menu" class="screen active">
            <h1>Umut Vadisi'nin Kaderi</h1>
            <div class="menu-buttons">
                <!-- Kilit ikonlarÄ± HTML'de kalÄ±yor, JS sÄ±nÄ±f ekleyip/kaldÄ±racak -->
                <button id="level-1-btn" class="unlocked">Seviye 1 <span class="lock-icon">ðŸ”’</span></button>
                <button id="level-2-btn" class="locked" disabled>Seviye 2 <span class="lock-icon">ðŸ”’</span></button>
                <button id="level-3-btn" class="locked" disabled>Seviye 3 <span class="lock-icon">ðŸ”’</span></button>
                <button id="how-to-play-btn">NasÄ±l OynanÄ±r?</button>
            </div>
        </div>

        <!-- 2. NasÄ±l OynanÄ±r EkranÄ± -->
        <div id="how-to-play" class="screen">
            <h2>NasÄ±l OynanÄ±r?</h2>
            <p>Bu oyunda, Umut Vadisi'nin kalkÄ±nmasÄ±ndan sorumlu bir yÃ¶netici/kÃ¢ÅŸifsin.</p>
            <p>KarÅŸÄ±na Ã§Ä±kan durumlarda, sana sunulan seÃ§eneklerden birini seÃ§erek hikayeyi ilerlet.</p>
            <p>SeÃ§imlerin, vadinin doÄŸal ve beÅŸeri faktÃ¶rlerini ne kadar iyi anladÄ±ÄŸÄ±nÄ± gÃ¶sterecek.</p>
            <p>DoÄŸru kararlar vadiyi geliÅŸtirirken, yanlÄ±ÅŸ kararlar olumsuz sonuÃ§lara veya oyunun bitmesine yol aÃ§abilir.</p>
            <p>AmacÄ±n, her seviyeyi baÅŸarÄ±yla tamamlayarak vadinin sÃ¼rdÃ¼rÃ¼lebilir kalkÄ±nmasÄ±nÄ± saÄŸlamaktÄ±r. Ä°yi ÅŸanslar!</p>
            <button id="back-to-menu-from-htp">AnladÄ±m, BaÅŸlayalÄ±m!</button>
        </div>

        <!-- 3. Oyun EkranÄ± -->
        <div id="game-screen" class="screen">
             <h2 id="level-title">Seviye BaÅŸlÄ±ÄŸÄ±</h2>
            <div id="story-text">Hikaye metni yÃ¼kleniyor...</div>
            <div id="choices">
                <!-- SeÃ§enek butonlarÄ± buraya eklenecek -->
            </div>
            <div id="feedback"></div>
             <button id="back-to-menu-from-game">Ana MenÃ¼ye DÃ¶n</button>
        </div>

        <!-- 4. Seviye TamamlandÄ± EkranÄ± -->
         <div id="level-complete" class="screen end-screen">
             <h2>Harika Ä°ÅŸ!</h2>
             <p id="level-complete-msg">Seviyeyi baÅŸarÄ±yla tamamladÄ±n!</p>
             <div class="button-container">
                <button id="next-level-btn" style="display: none;">Sonraki Seviye</button>
                <button id="back-to-menu-from-lc">Ana MenÃ¼ye DÃ¶n</button>
             </div>
         </div>

         <!-- 5. Oyun Bitti EkranÄ± -->
         <div id="game-over" class="screen end-screen">
              <h2>Dikkatli OlmalÄ±ydÄ±n!</h2>
              <p id="game-over-msg">Maalesef bu karar vadi iÃ§in iyi olmadÄ±.</p>
               <div class="button-container">
                  <button id="restart-level-btn">Tekrar Dene</button>
                  <button id="back-to-menu-from-go">Ana MenÃ¼ye DÃ¶n</button>
               </div>
         </div>

    </div>

    <script>
        // --- Element ReferanslarÄ± ---
        const screens = document.querySelectorAll('.screen');
        const mainMenuScreen = document.getElementById('main-menu');
        const howToPlayScreen = document.getElementById('how-to-play');
        const gameScreen = document.getElementById('game-screen');
        const levelCompleteScreen = document.getElementById('level-complete');
        const gameOverScreen = document.getElementById('game-over');

        const level1Btn = document.getElementById('level-1-btn');
        const level2Btn = document.getElementById('level-2-btn');
        const level3Btn = document.getElementById('level-3-btn');
        const howToPlayBtn = document.getElementById('how-to-play-btn');
        const backToMenuHtpBtn = document.getElementById('back-to-menu-from-htp');
        const backToMenuGameBtn = document.getElementById('back-to-menu-from-game');
        const backToMenuLcBtn = document.getElementById('back-to-menu-from-lc');
        const backToGoBtn = document.getElementById('back-to-menu-from-go');
        const nextLevelBtn = document.getElementById('next-level-btn');
        const restartLevelBtn = document.getElementById('restart-level-btn');


        const levelTitle = document.getElementById('level-title');
        const storyTextElement = document.getElementById('story-text');
        const choicesElement = document.getElementById('choices');
        const feedbackElement = document.getElementById('feedback');
        const levelCompleteMsg = document.getElementById('level-complete-msg');
        const gameOverMsg = document.getElementById('game-over-msg');

        // --- Oyun Verisi (Senaryolar aynÄ±, Ã¶nceki mesajdaki gibi) ---
        const gameData = {
            1: { // Seviye 1: DoÄŸal FaktÃ¶rlerin GÃ¼cÃ¼
                title: "Seviye 1: DoÄŸal FaktÃ¶rlerin GÃ¼cÃ¼",
                stages: {
                    0: { // BaÅŸlangÄ±Ã§
                        story: "KÃ¢ÅŸif, Umut Vadisi'nin potansiyelini ortaya Ã§Ä±karma gÃ¶revi sende! Vadinin DOÄžAL FAKTÃ–RLERÄ° ÅŸunlar: Ana yollara biraz uzak bir COÄžRAFÄ° KONUM, tarÄ±ma uygun Ä±lÄ±man Ä°KLÄ°M, verimli ovalar ve engebeli YER ÅžEKÄ°LLERÄ°, bol SU KAYNAKLARI, verimli TOPRAK, sÄ±k BÄ°TKÄ° Ã–RTÃœSÃœ (orman) ve potansiyel MADEN yataklarÄ±. KalkÄ±nmayÄ± baÅŸlatmak iÃ§in hangi EKONOMÄ°K FAALÄ°YETE Ã¶ncelik vermelisin?",
                        choices: [
                            { text: "A) TarÄ±m: Ä°KLÄ°M, SU ve TOPRAK avantajlarÄ±nÄ± kullanarak baÅŸlayalÄ±m.", nextStage: 1, isCorrect: true },
                            { text: "B) Madencilik ve Sanayi: Tepelerdeki MADEN potansiyelini araÅŸtÄ±rÄ±p sanayi kuralÄ±m.", nextStage: 'gameOver_MadenRisk', isCorrect: false },
                            { text: "C) DoÄŸa Turizmi: OrmanlÄ±k BÄ°TKÄ° Ã–RTÃœSÃœ ve YER ÅžEKÄ°LLERÄ°'ni kullanarak doÄŸa turizmini geliÅŸtirelim.", nextStage: 'gameOver_TurizmErken', isCorrect: false } // KÄ±ÅŸ turizmi yerine daha genele odaklanÄ±ldÄ±.
                        ],
                        feedbackCorrect: "MÃ¼kemmel baÅŸlangÄ±Ã§! Vadinin en gÃ¼Ã§lÃ¼ DOÄžAL FAKTÃ–RLERÄ° olan Ä°KLÄ°M, SU ve TOPRAK ile tarÄ±ma odaklanmak akÄ±llÄ±ca.",
                        feedbackIncorrectBase: "Bu seÃ§enek ÅŸu anki DOÄžAL FAKTÃ–RLER aÃ§Ä±sÄ±ndan riskli. Madenlerin durumu belirsiz ve turizm iÃ§in Ã¶nce altyapÄ± gerekebilir."
                    },
                    1: { // TarÄ±m baÅŸarÄ±lÄ±, UlaÅŸÄ±m sorunu
                        story: "TarÄ±m harika gidiyor! Ancak Ã¼rÃ¼nleri satmak zor. Vadinin uzak COÄžRAFÄ° KONUMU ve engebeli YER ÅžEKÄ°LLERÄ° nedeniyle ULAÅžIM (beÅŸeri faktÃ¶r) yetersiz. ÃœrÃ¼nler pazara ulaÅŸamÄ±yor. Bu sorunu nasÄ±l Ã§Ã¶zersin?",
                        choices: [
                            { text: "A) Modern Karayolu: YER ÅžEKÄ°LLERÄ°'nin zorluÄŸuna raÄŸmen vadiyi ana yola baÄŸlayacak bir yol inÅŸa edelim.", nextStage: 2, isCorrect: true },
                            { text: "B) GÄ±da Ä°ÅŸleme Tesisi: ÃœrÃ¼nleri iÅŸleyerek (TEKNOLOJÄ°) deÄŸerini artÄ±ralÄ±m ve taÅŸÄ±ma sorununu hafifletelim.", nextStage: 3, isCorrect: true },
                            { text: "C) HavaalanÄ±: ÃœrÃ¼nleri hÄ±zla taÅŸÄ±mak iÃ§in kÃ¼Ã§Ã¼k bir kargo havaalanÄ± yapalÄ±m.", nextStage: 'gameOver_HavaalaniMaliyet', isCorrect: false } // Nehir yerine daha maliyetli bir seÃ§enek.
                        ],
                         feedbackCorrect: "Ä°yi dÃ¼ÅŸÃ¼ndÃ¼n! Ya DOÄžAL engelleri (YER ÅžEKÄ°LLERÄ°, KONUM) BEÅžERÄ° bir Ã§Ã¶zÃ¼mle (ULAÅžIM) aÅŸmaya Ã§alÄ±ÅŸÄ±yorsun ya da TEKNOLOJÄ° ile uyum saÄŸlÄ±yorsun.",
                         feedbackIncorrectBase: "HavaalanÄ± bu aÅŸamada Ã§ok yÃ¼ksek maliyetli (SERMAYE) ve gereksiz olabilir. Daha temel Ã§Ã¶zÃ¼mler lazÄ±m."
                    },
                    2: { // Karayolu seÃ§ildi -> BaÅŸarÄ±
                        story: "Karayolu inÅŸaatÄ± tamamlandÄ±! Zorlu YER ÅžEKÄ°LLERÄ° aÅŸÄ±ldÄ± ve vadi artÄ±k ana ULAÅžIM aÄŸlarÄ±na baÄŸlandÄ±. TarÄ±m Ã¼rÃ¼nleri kolayca pazarlanÄ±yor, vadinin geliri arttÄ±. COÄžRAFÄ° KONUM dezavantajÄ± aÅŸÄ±ldÄ±!",
                        isLevelComplete: true,
                         levelCompleteText: "Seviye 1 tamamlandÄ±! DOÄžAL FAKTÃ–RLERÄ°N (Yer Åžekilleri, Konum) ULAÅžIM Ã¼zerindeki etkisini ve BEÅžERÄ° Ã§Ã¶zÃ¼mlerle aÅŸÄ±labileceÄŸini gÃ¶rdÃ¼n."
                    },
                     3: { // GÄ±da Ä°ÅŸleme Tesisi seÃ§ildi -> BaÅŸarÄ±
                        story: "GÄ±da iÅŸleme tesisi kuruldu! BEÅžERÄ° FAKTÃ–RLER (TEKNOLOJÄ°, SERMAYE) sayesinde tarÄ±m Ã¼rÃ¼nlerinin deÄŸeri arttÄ± ve raf Ã¶mrÃ¼ uzadÄ±. COÄžRAFÄ° KONUM'dan kaynaklanan ULAÅžIM zorluklarÄ± azaldÄ±. Vadi zenginleÅŸiyor!",
                        isLevelComplete: true,
                        levelCompleteText: "Seviye 1 tamamlandÄ±! DOÄžAL kaynaklarÄ± BEÅžERÄ° FAKTÃ–RLERLE (Teknoloji, Sermaye) daha verimli kullanmanÄ±n Ã¶nemini kavradÄ±n."
                    },
                    'gameOver_MadenRisk': {
                         story: "Aceleci karar! Potansiyel MADEN yataklarÄ±nÄ±n durumu belirsizken ve YER ÅžEKÄ°LLERÄ° nedeniyle ulaÅŸÄ±m zorken sanayiye yatÄ±rÄ±m yapmak SERMAYE israfÄ±na yol aÃ§tÄ±. Proje baÅŸarÄ±sÄ±z.",
                         isGameOver: true,
                         gameOverText: "DOÄžAL FAKTÃ–RLERDEN MADEN potansiyelini ve YER ÅžEKÄ°LLERÄ°'nin zorluÄŸunu yeterince dikkate almadÄ±n."
                    },
                     'gameOver_TurizmErken': {
                         story: "Erken bir adÄ±m! Vadinin BÄ°TKÄ° Ã–RTÃœSÃœ ve YER ÅžEKÄ°LLERÄ° turizm iÃ§in potansiyel sunsa da, yeterli ULAÅžIM ve konaklama (BEÅžERÄ° FAKTÃ–RLER) olmadan turist Ã§ekmek mÃ¼mkÃ¼n olmadÄ±. YatÄ±rÄ±m boÅŸa gitti.",
                         isGameOver: true,
                         gameOverText: "DOÄžAL FAKTÃ–RLERÄ°N turizm potansiyelini kullanmak iÃ§in gerekli BEÅžERÄ° FAKTÃ–RLERÄ° (UlaÅŸÄ±m, AltyapÄ±) gÃ¶z ardÄ± ettin."
                    },
                    'gameOver_HavaalaniMaliyet': {
                         story: "AÅŸÄ±rÄ± maliyetli! Bu aÅŸamada bir havaalanÄ± inÅŸa etmek iÃ§in gereken SERMAYE Ã§ok yÃ¼ksekti ve vadinin mevcut Ã¼retimi bu yatÄ±rÄ±mÄ± karÅŸÄ±lamÄ±yordu. Kaynaklar tÃ¼kendi.",
                         isGameOver: true,
                         gameOverText: "BEÅžERÄ° FAKTÃ–RLERDEN SERMAYE'yi ve mevcut ekonomik durumu doÄŸru analiz edemedin. Ã‡Ã¶zÃ¼mÃ¼n Ã¶lÃ§eÄŸi yanlÄ±ÅŸtÄ±."
                    }
                }
            },
             2: { // Seviye 2: BeÅŸeri FaktÃ¶rler
                 title: "Seviye 2: Ä°nsanÄ±n Etkisi",
                 stages: {
                    0: { // TarÄ±m geliÅŸti, beÅŸeri sorunlar baÅŸladÄ±
                         story: "Seviye 1 harika! TarÄ±m geliÅŸti, ama ÅŸimdi BEÅžERÄ° sorunlar var: HÄ±zla artan NÃœFUS iÃ§in konut ve hizmet yetersiz. Yeni iÅŸ kollarÄ± iÃ§in NÄ°TELÄ°KLÄ° Ä°Åž GÃœCÃœ lazÄ±m. Daha bÃ¼yÃ¼k yatÄ±rÄ±mlar iÃ§inse SERMAYE gerekiyor. Hangi BEÅžERÄ° FAKTÃ–RE Ã¶ncelik vermelisin?",
                         choices: [
                             { text: "A) EÄŸitim ve Mesleki Kurslar: HalkÄ±n becerilerini artÄ±rÄ±p NÄ°TELÄ°KLÄ° Ä°Åž GÃœCÃœ oluÅŸturalÄ±m.", nextStage: 1, isCorrect: true },
                             { text: "B) Devlet Destekli Konut Projesi: Artan NÃœFUS'un barÄ±nma sorununu DEVLET POLÄ°TÄ°KALARI ile Ã§Ã¶zelim.", nextStage: 'gameOver_SermayeYetmez2', isCorrect: false },
                             { text: "C) DÄ±ÅŸarÄ±dan GÃ¶Ã§ TeÅŸviki: FarklÄ± alanlarda uzmanlaÅŸmÄ±ÅŸ kiÅŸileri vadiye Ã§ekelim.", nextStage: 'gameOver_AltyapiYetersiz', isCorrect: false }
                         ],
                         feedbackCorrect: "Ã‡ok doÄŸru! Uzun vadeli kalkÄ±nma iÃ§in NÄ°TELÄ°KLÄ° Ä°Åž GÃœCÃœ yetiÅŸtirmek en saÄŸlam temeldir.",
                         feedbackIncorrectBase: "Konut ve dÄ±ÅŸarÄ±dan insan getirmek de Ã§Ã¶zÃ¼m olabilir ama Ã¶nce iÃ§erideki potansiyeli geliÅŸtirmek daha sÃ¼rdÃ¼rÃ¼lebilir olabilir."
                     },
                     1: { // EÄŸitim baÅŸarÄ±lÄ±, sanayi potansiyeli
                         story: "EÄŸitim yatÄ±rÄ±mlarÄ± meyvesini verdi! Vadide artÄ±k daha NÄ°TELÄ°KLÄ° bir Ä°Åž GÃœCÃœ var. Åžimdi, tarÄ±ma ek olarak yeni bir ekonomik faaliyet daha baÅŸlatmak iÃ§in uygun bir zaman. Ne Ã¶nerirsin?",
                        choices: [
                             { text: "A) Hafif Sanayi: TarÄ±m Ã¼rÃ¼nlerini iÅŸleyen veya basit tÃ¼ketim mallarÄ± Ã¼reten kÃ¼Ã§Ã¼k fabrikalar (TEKNOLOJÄ° kullanÄ±mÄ±).", nextStage: 'level2_complete', isCorrect: true },
                             { text: "B) Teknopark Kurulumu: YÃ¼ksek TEKNOLOJÄ° ve yazÄ±lÄ±m geliÅŸtirmeye odaklanalÄ±m.", nextStage: 'gameOver_TeknoErken', isCorrect: false },
                             { text: "C) BÃ¼yÃ¼kbaÅŸ HayvancÄ±lÄ±k: GeniÅŸ Ã§ayÄ±rlarÄ± kullanarak modern hayvancÄ±lÄ±k yapalÄ±m.", nextStage: 'gameOver_PazarSorunu', isCorrect: false } // DoÄŸal faktÃ¶re dÃ¶nÃ¼k ama beÅŸeri sorun yaratabilir
                        ],
                         feedbackCorrect: "MantÄ±klÄ±! Mevcut tarÄ±msal Ã¼retime ve geliÅŸen Ä°Åž GÃœCÃœNE dayalÄ± hafif sanayi, iyi bir sonraki adÄ±m.",
                         feedbackIncorrectBase: "Teknopark iÃ§in henÃ¼z yeterli SERMAYE ve uzmanlÄ±k birikimi olmayabilir. HayvancÄ±lÄ±k ise yeni pazar ve ULAÅžIM sorunlarÄ± yaratabilir."
                     },
                     'gameOver_SermayeYetmez2': {
                         story: "DEVLET POLÄ°TÄ°KALARI ile konut yapmak iyi niyetliydi ama vadinin henÃ¼z yeterli SERMAYE birikimi yoktu. Proje yarÄ±m kaldÄ±, kaynaklar boÅŸa harcandÄ±.",
                         isGameOver: true,
                         gameOverText: "BEÅžERÄ° FAKTÃ–RLERDEN SERMAYE'nin yeterliliÄŸini ve DEVLET POLÄ°TÄ°KALARI'nÄ±n zamanlamasÄ±nÄ± doÄŸru ayarlayamadÄ±n."
                     },
                     'gameOver_AltyapiYetersiz': {
                        story: "DÄ±ÅŸarÄ±dan NÃœFUS Ã§ekmek vadinin mevcut altyapÄ±sÄ±nÄ± (konut, saÄŸlÄ±k, ULAÅžIM) daha da zorladÄ±. Gelenler mutsuz oldu, sosyal sorunlar arttÄ±.",
                        isGameOver: true,
                        gameOverText: "NÃœFUS artÄ±ÅŸÄ±nÄ± planlarken mevcut BEÅžERÄ° altyapÄ±nÄ±n (ve SERMAYE'nin) yeterliliÄŸini gÃ¶z ardÄ± ettin."
                     },
                     'gameOver_TeknoErken': {
                        story: "Vizyoner bir fikir ama Teknopark iÃ§in gereken yÃ¼ksek TEKNOLOJÄ° bilgisi, SERMAYE ve uluslararasÄ± baÄŸlantÄ±lar vadide henÃ¼z mevcut deÄŸildi. YatÄ±rÄ±m atÄ±l kaldÄ±.",
                        isGameOver: true,
                        gameOverText: "BEÅžERÄ° FAKTÃ–RLERDEN TEKNOLOJÄ° seviyesi ve SERMAYE gereksinimini yanlÄ±ÅŸ deÄŸerlendirdin."
                      },
                      'gameOver_PazarSorunu': {
                        story: "HayvancÄ±lÄ±k geliÅŸti ama Ã¼retilen et ve sÃ¼t Ã¼rÃ¼nlerini satacak yeterli Pazar (ULAÅžIM ve TÄ°CARET baÄŸlantÄ±larÄ± - beÅŸeri faktÃ¶rler) bulunamadÄ±. ÃœrÃ¼nler elde kaldÄ±.",
                        isGameOver: true,
                        gameOverText: "Yeni bir DOÄžAL kaynaÄŸa (Ã§ayÄ±rlar) dayalÄ± Ã¼retim yaparken, bunun gerektirdiÄŸi BEÅžERÄ° faktÃ¶rleri (Pazar, UlaÅŸÄ±m) eksik planladÄ±n."
                      },
                     'level2_complete': {
                         story: "Harika bir hamle! Hafif sanayi tesisleri, hem yerel tarÄ±m Ã¼rÃ¼nlerini deÄŸerlendirdi hem de NÄ°TELÄ°KLÄ° Ä°Åž GÃœCÃœNE yeni istihdam saÄŸladÄ±. Vadi artÄ±k daha dengeli bir ekonomiye sahip.",
                         isLevelComplete: true,
                         levelCompleteText: "Seviye 2 tamamlandÄ±! BEÅžERÄ° FAKTÃ–RLERÄ°N (NÃ¼fus, Ä°ÅŸ gÃ¼cÃ¼, Sermaye, Teknoloji) birbirini nasÄ±l etkilediÄŸini ve yÃ¶netilmesi gerektiÄŸini Ã¶ÄŸrendin."
                     }
                 }
             },
              3: { // Seviye 3: DoÄŸal ve BeÅŸeri Dengesi
                 title: "Seviye 3: KalkÄ±nma ve Ã‡evre Dengesi",
                  stages: {
                     0: {
                         story: "Vadi geliÅŸiyor ama alarm zilleri Ã§alÄ±yor! YoÄŸun tarÄ±m TOPRAÄžI yoruyor, artan NÃœFUS ve sanayi SU KAYNAKLARINI kirletiyor, yeni yollar BÄ°TKÄ° Ã–RTÃœSÃœNÃœ (ORMANLARI) tehdit ediyor. DEVLET POLÄ°TÄ°KALARI ile sÃ¼rdÃ¼rÃ¼lebilir bir denge kurmalÄ±sÄ±n. Ä°lk adÄ±m ne olmalÄ±?",
                        choices: [
                            { text: "A) KatÄ± Ã‡evre YasalarÄ±: KirliliÄŸi ve orman kesimini hemen yasaklayan DEVLET POLÄ°TÄ°KALARI uygulayalÄ±m.", nextStage: 'gameOver_EkonomiDurur', isCorrect: false },
                            { text: "B) TEKNOLOJÄ° ve Planlama: ArÄ±tma tesisleri, modern sulama, planlÄ± ormancÄ±lÄ±k gibi BEÅžERÄ° Ã§Ã¶zÃ¼mlere yÃ¶nelelim.", nextStage: 'level3_complete', isCorrect: true },
                            { text: "C) Turizmi GeliÅŸtirme: DOÄžAL FAKTÃ–RLERÄ° koruyarak ekoturizme odaklanalÄ±m (DEVLET TEÅžVÄ°KLERÄ° ile).", nextStage: 'gameOver_YetersizCozum', isCorrect: false }
                        ],
                        feedbackCorrect: "TEKNOLOJÄ° ve planlama gibi BEÅžERÄ° FAKTÃ–RLER, kalkÄ±nma ile DOÄžAL FAKTÃ–RLERÄ°N korunmasÄ± arasÄ±nda denge kurmanÄ±n anahtarÄ±dÄ±r.",
                        feedbackIncorrectBase: "Dengeyi kurmak Ã¶nemli, ancak seÃ§tiÄŸin yÃ¶ntem tek baÅŸÄ±na yeterli olmayabilir veya ekonomiyi olumsuz etkileyebilir..."
                     },
                      'gameOver_EkonomiDurur': {
                         story: "YanlÄ±ÅŸ Karar! Ani ve katÄ± DEVLET POLÄ°TÄ°KALARI (yasaklar) ekonomik faaliyetleri durma noktasÄ±na getirdi. Ä°ÅŸsizlik arttÄ±, halk mutsuz. Ã‡evreyi korurken BEÅžERÄ° FAKTÃ–RLERÄ° (ekonomi, nÃ¼fus) de dÃ¼ÅŸÃ¼nmeliydin.",
                         isGameOver: true,
                         gameOverText: "DEVLET POLÄ°TÄ°KALARI'nÄ± dengeli kullanamadÄ±n, BEÅžERÄ° faktÃ¶rler zarar gÃ¶rdÃ¼."
                     },
                     'gameOver_YetersizCozum': {
                         story: "YanlÄ±ÅŸ Karar! Ekoturizm iyi bir fikir olsa da tek baÅŸÄ±na mevcut kirlilik (SU KAYNAKLARI) ve kaynak tÃ¼ketimi (TOPRAK, BÄ°TKÄ° Ã–RTÃœSÃœ) sorunlarÄ±nÄ± Ã§Ã¶zmeye yetmedi. Sorunlar bÃ¼yÃ¼meye devam etti.",
                         isGameOver: true,
                         gameOverText: "Sorunun kÃ¶kÃ¼ne inen, hem DOÄžAL hem BEÅžERÄ° faktÃ¶rleri gÃ¶zeten daha kapsamlÄ± bir Ã§Ã¶zÃ¼m gerekiyordu."
                     },
                     'level3_complete': {
                         story: "MÃ¼kemmel! AkÄ±llÄ± TEKNOLOJÄ° yatÄ±rÄ±mlarÄ± (arÄ±tma, verimli sulama) ve dikkatli PLANLAMA (DEVLET POLÄ°TÄ°KALARI ile desteklenen planlÄ± ormancÄ±lÄ±k, sanayi bÃ¶lgeleri) sayesinde hem DOÄžAL FAKTÃ–RLER (TOPRAK, SU, BÄ°TKÄ° Ã–RTÃœSÃœ) korundu hem de BEÅžERÄ° FAKTÃ–RLER (ekonomik geliÅŸme, NÃœFUS refahÄ±) sÃ¼rdÃ¼rÃ¼lebilir hale geldi. Umut Vadisi artÄ±k bir baÅŸarÄ± Ã¶ykÃ¼sÃ¼!",
                         isLevelComplete: true,
                         levelCompleteText: "Tebrikler! TÃ¼m seviyeleri tamamladÄ±n! DOÄžAL ve BEÅžERÄ° FAKTÃ–RLERÄ° dengeleyerek kalkÄ±nmayÄ± baÅŸardÄ±n!"
                     }
                 }
             }
        }; // gameData bitti

        // --- Oyun Durumu ---
        let currentLevel = 0;
        let currentStageId = 0;
        let unlockedLevels = [1]; // BaÅŸlangÄ±Ã§ta sadece seviye 1 aÃ§Ä±k
        let typewriterInterval = null;
        const TYPEWRITER_SPEED = 25;

        // --- Fonksiyonlar ---

        function showScreen(screenId) {
            screens.forEach(screen => screen.classList.remove('active'));
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                if (screenId === 'main-menu') { updateLevelButtons(); } // Ekran gÃ¶sterildiÄŸinde butonlarÄ± gÃ¼ncelle
            } else {
                console.error("Hata: Ekran bulunamadÄ± -", screenId);
                showScreen('main-menu');
            }
        }

        function typeWriter(element, text, speed, callback) {
            let i = 0;
            element.innerHTML = "";
            element.classList.add('typewriter-cursor');
            if (typewriterInterval) { clearInterval(typewriterInterval); typewriterInterval = null; }
            disableChoices();

            typewriterInterval = setInterval(() => {
                if (element && i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                } else {
                    clearInterval(typewriterInterval);
                    typewriterInterval = null;
                    if(element) element.classList.remove('typewriter-cursor');
                     const stage = gameData[currentLevel]?.stages[currentStageId];
                     if (callback && stage && ( (stage.choices && stage.choices.length > 0) || stage.isLevelComplete || stage.isGameOver) ) {
                        // YazÄ± bittikten SONRA callback'i Ã§aÄŸÄ±r (seÃ§enek varsa veya oyun bittiyse)
                        callback();
                     } else {
                         // SeÃ§enek yoksa ve oyun/seviye bitmediyse butonlarÄ± etkinleÅŸtirme (veya baÅŸka bir iÅŸlem)
                     }
                }
            }, speed);
        }

        function disableChoices() {
            const buttons = choicesElement.querySelectorAll('button');
            buttons.forEach(button => button.disabled = true);
        }

        function enableChoices() {
            const buttons = choicesElement.querySelectorAll('button');
            // Sadece yazÄ± efekti bittiyse ve geri bildirim yoksa aktif et
            if (!feedbackElement.textContent.trim() && !typewriterInterval) {
                  buttons.forEach(button => button.disabled = false);
            }
        }

         function saveProgress() {
             try {
                localStorage.setItem('unlockedLevels', JSON.stringify(unlockedLevels));
             } catch (e) { console.warn("LocalStorage kullanÄ±lamÄ±yor:", e); }
         }

         // SEVÄ°YE BUTON GÃœNCELLEME FONKSÄ°YONU (DÃœZELTÄ°LDÄ°)
         function updateLevelButtons() {
             const buttons = [level1Btn, level2Btn, level3Btn];
             buttons.forEach((btn, index) => {
                 const levelNum = index + 1;
                 const isUnlocked = unlockedLevels.includes(levelNum);

                 btn.disabled = !isUnlocked; // Butonu kilitle/aÃ§

                 // SÄ±nÄ±fÄ± gÃ¼ncelle (CSS ikonu buna gÃ¶re yÃ¶netecek)
                 if (isUnlocked) {
                     btn.classList.remove('locked');
                     btn.classList.add('unlocked');
                 } else {
                     btn.classList.add('locked');
                     btn.classList.remove('unlocked');
                 }
             });
         }


        function startGame(level) {
            if (!unlockedLevels.includes(level) || !gameData[level]) {
                console.warn(`UyarÄ±: Seviye ${level} kilitli veya mevcut deÄŸil.`);
                return;
            }
            currentLevel = level;
            currentStageId = 0;
            levelTitle.textContent = gameData[currentLevel].title;
            feedbackElement.textContent = "";
            feedbackElement.className = 'feedback';
            displayStage(currentStageId);
            showScreen('game-screen');
        }

        function displayStage(stageId) {
             const levelData = gameData[currentLevel];
             if (!levelData) { console.error(`Hata: Seviye ${currentLevel} verisi!`); showScreen('main-menu'); return; }
             const stage = levelData.stages[stageId];
             if (!stage) { console.error(`Hata: Seviye ${currentLevel}, Sahne ${stageId}!`); showScreen('main-menu'); return; }

             choicesElement.innerHTML = '';
             feedbackElement.textContent = "";
             feedbackElement.className = 'feedback';

             typeWriter(storyTextElement, stage.story, TYPEWRITER_SPEED, () => {
                 // YazÄ± bittikten SONRA yapÄ±lacaklar:
                 if (stage.choices && stage.choices.length > 0) {
                     renderChoices(stage.choices); // SeÃ§enekleri oluÅŸtur
                 } else if (stage.isLevelComplete) {
                      handleLevelComplete(stage); // Seviye bitiÅŸini iÅŸle
                 } else if (stage.isGameOver) {
                      handleGameOver(stage); // Oyun sonunu iÅŸle
                 }
             });
        }

        function renderChoices(choices) {
            choicesElement.innerHTML = '';
            choices.forEach((choice) => {
                const button = document.createElement('button');
                button.innerHTML = choice.text; // Vurgular iÃ§in innerHTML
                button.onclick = () => handleChoice(choice);
                choicesElement.appendChild(button);
            });
            // Butonlar render edilince aktif edilebilir (eÄŸer typewriter bittiyse)
             if (!typewriterInterval) enableChoices();
        }

        function handleChoice(choice) {
             disableChoices();
             const stage = gameData[currentLevel].stages[currentStageId];
             let nextStageId = choice.nextStage;

             feedbackElement.className = choice.isCorrect ? 'feedback correct' : 'feedback incorrect';
             feedbackElement.textContent = choice.isCorrect ? (stage.feedbackCorrect || "DoÄŸru!") : (stage.feedbackIncorrectBase || "Pek iyi olmadÄ±...");

             setTimeout(() => {
                 const nextStageData = gameData[currentLevel].stages[nextStageId];
                 if (nextStageData) {
                     currentStageId = nextStageId;
                     displayStage(currentStageId); // Bir sonraki sahneyi gÃ¶ster
                 } else {
                     console.error(`Hata: Sonraki aÅŸama (${nextStageId}) bulunamadÄ±!`);
                     showScreen('main-menu');
                 }
             }, 2000); // Geri bildirimi okumak iÃ§in sÃ¼re
        }

        function handleLevelComplete(stage) {
             levelCompleteMsg.innerHTML = stage.levelCompleteText || `Seviye ${currentLevel} tamamlandÄ±!`;
             const nextLevel = currentLevel + 1;
             if (gameData[nextLevel] && !unlockedLevels.includes(nextLevel)) {
                 unlockedLevels.push(nextLevel);
                 saveProgress();
                 nextLevelBtn.style.display = 'inline-block';
                 nextLevelBtn.onclick = () => startGame(nextLevel);
             } else {
                  nextLevelBtn.style.display = 'none';
             }
              // Seviye tamamlandÄ± ekranÄ±nÄ± gÃ¶ster (displayStage bittikten sonra)
             showScreen('level-complete');
         }

         function handleGameOver(stage) {
             gameOverMsg.innerHTML = stage.gameOverText || "Oyun bitti.";
             restartLevelBtn.onclick = () => startGame(currentLevel);
             // Oyun bitti ekranÄ±nÄ± gÃ¶ster (displayStage bittikten sonra)
              showScreen('game-over');
         }


        // --- Olay Dinleyicileri ---
        level1Btn.onclick = () => startGame(1);
        level2Btn.onclick = () => startGame(2);
        level3Btn.onclick = () => startGame(3);
        howToPlayBtn.onclick = () => showScreen('how-to-play');
        backToMenuHtpBtn.onclick = () => showScreen('main-menu');
        backToMenuGameBtn.onclick = () => showScreen('main-menu');
        backToMenuLcBtn.onclick = () => showScreen('main-menu');
        backToGoBtn.onclick = () => showScreen('main-menu');


        // --- Oyun BaÅŸlangÄ±cÄ± ---
        try {
            const savedLevels = localStorage.getItem('unlockedLevels');
            unlockedLevels = savedLevels ? JSON.parse(savedLevels) : [1];
            if (!Array.isArray(unlockedLevels) || !unlockedLevels.includes(1)) {
                unlockedLevels = [1]; // HatalÄ± veri varsa sÄ±fÄ±rla
            }
        } catch (e) {
            console.warn("LocalStorage okunamadÄ±:", e);
            unlockedLevels = [1];
        }
        // Ana menÃ¼yÃ¼ gÃ¶ster ve butonlarÄ± ilk kez doÄŸru ayarla
        showScreen('main-menu');

    </script>

</body>
</html>